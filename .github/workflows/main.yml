# name: Development Workflow

# on:
#   push:
#     branches:
#       - designing
# jobs:
#   deploy:
#     runs-on: ubuntu-latest
#     env:
#       AWS_ACCESS_KEY_ID: '${{ secrets.AWS_ACCESS_KEY_ID }}'
#       AWS_SECRET_ACCESS_KEY: '${{ secrets.AWS_SECRET_ACCESS_KEY }}'
#     steps:
#       - uses: actions/checkout@v2
#       - name: Set up nodejs 14 LTS
#         uses: actions/setup-node@v2
#         with:
#           node-version: '12'

#       - name: Copy a file from s3
#         uses: prewk/s3-cp-action@v2
#         with:
#          aws_access_key_id: ${{ secrets.AWS_ACCESS_KEY_ID }}
#          aws_secret_access_key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
#          source: 's3://xord-testing/node-modules/node_modules.zip'
#          dest: '.'
         
#       - name: Unzip modules
#         run: unzip -o node_modules.zip
      
#       - name: Cache node_modules
#         uses: actions/cache@v2.0.0
#         with:
#           path: node_modules
#           key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
#           restore-keys: |
#             ${{ runner.os }}-node-${{ env.cache-name }}-
#             ${{ runner.os }}-node-
#             ${{ runner.os }}-
            
#       - name: building new build
#         run: npm run build
#         env:
#           REACT_APP_TRANSAK_API: ${{ secrets.REACT_APP_TRANSAK_API }}
      
#       - name: give execution permission
#         run: chmod +x changes.sh
        
#       - name: Run script
#         run: ./changes.sh


#       - uses: akhileshns/heroku-deploy@v3.12.12 # This is the action
#         with:
#           heroku_api_key: ${{secrets.HEROKU_API_KEY}}
#           heroku_app_name: "phoenixdao-event" #Must be unique in Heroku
#           heroku_email: "arham.tahir@xord.com"
          
#       - name: Push to Heroku
#         run: git push heroku master

name: Firebase CI

on:
  push:
    branches: [ designing ]
  
jobs:
  build:

    runs-on: ubuntu-latest

    strategy:
      matrix:
        node-version: [14.x]
        # See supported Node.js release schedule at https://nodejs.org/en/about/releases/

    steps:
    - uses: actions/checkout@v2
    - name: Use Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v1
      with:
        node-version: ${{ matrix.node-version }}
    - run: npm install -g yarn
    - name: yarn build and test
      run: |
        yarn build
    - name: Archive Build
      uses: actions/upload-artifact@v2
      with:
        name: build
        path: build
        
  deploy:
    name: Deploy
    needs: build
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Download Build
        uses: actions/download-artifact@v2
        with:
          name: build
          path: build
      - name: Depoy to Firebase
        uses: w9jds/firebase-action@master
        with:
          args: deploy --only hosting
        env:
          FIREBASE_TOKEN: ${{ secrets.FIREBASE_TOKEN }}
